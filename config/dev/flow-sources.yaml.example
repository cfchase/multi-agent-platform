# Flow Sources Configuration (Cluster)
# Copy to flow-sources.yaml to use as-is, or customize for your environment.
#
# Three top-level sections:
#   components:   Custom LangFlow component directories (installs deps, copies .py files)
#   mcp_servers:  MCP server configurations to register in LangFlow
#   flows:        Flow definitions to import into LangFlow
#
# Flow types:
#   - file: Single JSON file (local path or URL)
#   - local: Directory of JSON files (scans with pattern)
#   - git: Git repository (clones and scans with pattern)
#
# Common flow options:
#   - project: LangFlow project name to import into (created if missing)
#   - pattern: Glob pattern for finding flow files (default: **/*.json)
#   - public: Set to true to make flows visible to all users (default: false)

# --- Components: custom LangFlow components to install ---
# Components can load from a local path or a git repo.
# For git: specify 'git' (URL) and 'branch', with 'path' as subdirectory.
#
# CLUSTER NOTE: When using the custom agents-python-langflow image,
# enterprise agent components are pre-installed in the image at /app/components.
# Only enable component entries below for additional components not in the image.
#
# For stock LangFlow image, components are installed on the cluster pod via
# `oc cp` and `oc exec` when running `make langflow-import-cluster`.
components:

  # Platform components (UserSettings, AppSettings, GoogleDriveValidator)
  # NOTE: Pre-installed in agents-python-langflow image. Only enable for stock LangFlow.
  - name: platform-components
    git: https://github.com/cfchase/langflow-examples
    branch: main
    path: components/platform
    category: platform
    dependencies: []
    enabled: false

  # Example components (HelloWorldEcho, HelloWorldDep)
  - name: example-components
    git: https://github.com/cfchase/langflow-examples
    branch: main
    path: components/examples
    category: examples
    dependencies:
      - humanize>=4.0.0
    enabled: true

# --- MCP Servers: MCP server configurations to register ---
#
# CLUSTER NOTE: MCP servers are registered on the cluster pod via `oc exec`
# when running `make langflow-import-cluster`. Pip dependencies are installed
# on the pod and server configs are merged into LangFlow project files.
mcp_servers:

  # dept-toolserver runs as a sidecar in the langflow pod (same pod, localhost)
  - name: dept-toolserver
    type: sse
    url: http://localhost:8086/sse

  - name: server-fetch
    type: stdio
    command: python
    args:
      - "-m"
      - "mcp_server_fetch"
    dependencies:
      - mcp-server-fetch

# --- Flows: flow definitions to import into LangFlow ---
flows:

  # Enterprise agent flow from agents-python-langflow (GitLab)
  - name: enterprise-agent-multiuser
    type: git
    url: https://gitlab.cee.redhat.com/cchase/agents-python-langflow
    branch: main
    pattern: "flows/redhat-enterprise-agent-multiuser.json"
    project: "Enterprise Agent"
    public: true
    enabled: true

  # Import all flows from langflow-examples via git
  - name: langflow-examples
    type: git
    url: https://github.com/cfchase/langflow-examples
    branch: main
    pattern: "**/*.json"
    project: "Examples"
    public: true
    enabled: true
