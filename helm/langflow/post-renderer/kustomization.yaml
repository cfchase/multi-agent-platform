apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - helm-output.yaml
patches:
  # JSON patch: fix security context for OpenShift restricted-v2 SCC on StatefulSet
  - path: security-context-patch.yaml
    target:
      kind: StatefulSet
      name: langflow-service
  # JSON patch: fix security context for OpenShift restricted-v2 SCC on frontend Deployment
  - path: security-context-patch.yaml
    target:
      kind: Deployment
      name: langflow-service-frontend
  # Strategic merge patch: add OAuth proxy sidecar, env vars, volumes to StatefulSet
  - path: oauth-proxy-patch.yaml
    target:
      kind: StatefulSet
      name: langflow-service
  # Strategic merge patch: load all langflow-credentials env vars into Langflow container
  - path: langflow-credentials-patch.yaml
    target:
      kind: StatefulSet
      name: langflow-service
  # Strategic merge patch: add PVC for /tmp/langflow (components, packages, MCP configs)
  - path: langflow-data-pvc-patch.yaml
    target:
      kind: StatefulSet
      name: langflow-service
